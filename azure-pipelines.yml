trigger:
  branches:
    include:
      - main

variables:
- group: terraform-backend  # Variable Group cu credentialele SP

pool:
  name: Local-Agent          # Numele pool-ului creat Ã®n Project Settings

steps:
- checkout: self

- script: terraform --version
  displayName: 'VerificÄƒ versiunea Terraform'

- script: |
    echo "ğŸ” Autentificare cu SP"
    echo "Client ID: $ARM_CLIENT_ID"
    echo "Tenant ID: $ARM_TENANT_ID"
    echo "Subscription ID: $ARM_SUBSCRIPTION_ID"

    echo "ğŸŒ Terraform Init"
    terraform init

    echo "ğŸ“ Terraform Plan"
    terraform plan -out=tfplan
  displayName: 'Terraform Init & Plan'

- script: |
    echo "ğŸš€ Terraform Apply"
    terraform apply -auto-approve tfplan
  displayName: 'Terraform Apply'